{% extends 'base.html' %}
{% load static %}

{% block title %}{% if course %}Edit Course: {{ course.code }}{% else %}Create New Course{% endif %} - EagleOps{% endblock %}

{% block content %}
<div class="page-container">
  <div class="section">
    <div class="page-header">
      <!-- Back to Courses as a Button -->
      <a href="{% url 'courses' %}" class="back-button">
        <i class="fas fa-arrow-left" style="margin-right: 8px;"></i> Back to Courses
      </a>
      <h1>
        {% if course %}Edit Course: {{ course.code }}{% else %}Create New Course{% endif %}
      </h1>
    </div>

    {% if error_message %}
      <div class="error-message">
        {{ error_message }}
      </div>
    {% endif %}

    <form id="courseForm" method="post" action="{% if course %}{% url 'edit_course' course_id=course.id %}{% else %}{% url 'create_course' %}{% endif %}" class="neu-form">
      {% csrf_token %}
      <div class="form-group">
        <label for="name">Course Name<span class="required">*</span></label>
        <input type="text" id="name" name="name" class="neu-input" required value="{% if course %}{{ course.name }}{% endif %}">
      </div>
      <div class="form-group">
        <label for="code">Course Code<span class="required">*</span></label>
        <input type="text" id="code" name="code" class="neu-input" required value="{% if course %}{{ course.code }}{% endif %}">
        <small class="help-text">E.g., CS101, ENGL201, etc.</small>
      </div>
      <div class="form-group">
        <label for="description">Description</label>
        <textarea id="description" name="description" class="neu-input" rows="4">{% if course %}{{ course.description }}{% endif %}</textarea>
      </div>
      <div class="form-actions">
        <a href="{% url 'courses' %}" class="neu-btn btn-secondary">Cancel</a>
        <button type="submit" class="neu-btn btn-primary">
          {% if course %}Update Course{% else %}Create Course{% endif %}
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="neu-loading">
  <div class="spinner"></div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  // Show loading overlay when the form is submitted
  document.getElementById('courseForm').addEventListener('submit', function() {
    document.getElementById('loadingOverlay').style.display = 'flex';
  });
</script>
{% endblock %}
